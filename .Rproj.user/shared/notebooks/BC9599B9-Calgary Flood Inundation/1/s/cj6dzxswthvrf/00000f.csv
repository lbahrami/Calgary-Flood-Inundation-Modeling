"0","# iterateThresholds function"
"0","iterateThresholds <- function(data, group) {"
"0","  group <- enquo(group)"
"0","  x = .01"
"0","  all_prediction <- data.frame()"
"0","  while (x <= 1) {"
"0","    "
"0","    this_prediction <-"
"0","      testProbs %>%"
"0","      mutate(predOutcome = ifelse(pred > x, 1, 0)) %>%"
"0","      group_by(!!group) %>%"
"0","      dplyr::count(predOutcome, obs) %>%"
"0","      dplyr::summarize(sum_TN = sum(n[predOutcome==0 & obs==0]),"
"0","                       sum_TP = sum(n[predOutcome==1 & obs==1]),"
"0","                       sum_FN = sum(n[predOutcome==0 & obs==1]),"
"0","                       sum_FP = sum(n[predOutcome==1 & obs==0]),"
"0","                       total=sum(n)) %>%"
"0","      mutate(True_Positive = sum_TP / total,"
"0","             True_Negative = sum_TN / total,"
"0","             False_Negative = sum_FN / total,"
"0","             False_Positive = sum_FP / total,"
"0","             Accuracy = (sum_TP + sum_TN) / total, Threshold = x)"
"0","    "
"0","    all_prediction <- rbind(all_prediction, this_prediction)"
"0","    x <- x + .01"
"0","  }"
"0","  return(all_prediction)"
"0","}"
"0",""
"0",""
"0","whichThreshold <- iterateThresholds(testProbs)"
"0",""
"0","allThresholds<-kable(whichThreshold) %>%"
"0","  kable_styling(bootstrap_options = ""striped"", full_width = FALSE)%>%"
"0","  scroll_box(width = ""100%"", height = ""500px"")"
"0",""
"0","allThresholds"
